<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>글 상세 조회</title>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">	
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
<form id = "writeForm">
  <input type="hidden" id="boardId" name="boardId" th:value="${detail.boardId}">
  <div class="mb-3">
    <label for="exampleInputEmail1" class="form-label">글 제목</label>
    <input type="text" class="form-control" id="boardTitle" name="boardTitle" th:value="${detail.boardTitle}">
  </div>
  <div class="mb-3">
    <label for="exampleInputPassword1" class="form-label">작성자</label>
    <input type="text" class="form-control" id="boardWriter" name="boardWriter" th:value="${detail.boardWriter}">
  </div>
  <div class="mb-3">
  	<label for="floatingTextarea" class="form-label">글 내용</label>
  	<textarea class="form-control"  id="boardContents" name="boardContents">[[${detail.boardContents}]]</textarea>
  </div>
  <div class="mb-3">
    <label for="exampleInputPassword1" class="form-label">작성일자</label>
    <input type="text" class="form-control" id="exampleInputPassword1" name="regDate" readonly="readonly" th:value="${detail.regDate}">
  </div>
  <div class="mb-3">
    <label for="exampleInputPassword1" class="form-label">수정일자</label>
    <input type="text" class="form-control" id="exampleInputPassword1" name="updateDate" readonly="readonly" th:value="${detail.updateDate}">
  </div>
  <button type="button" class="btn btn-primary" onclick="boardupdate()">글수정</button>
  <button type="reset" class="btn btn-primary" onclick="boardDelete()">글삭제</button>
  <button type="button" class="btn btn-primary"  onclick="backlist()">목록으로가기</button>
</form>
</body>
<script type="text/javascript" th:inline="javascript">
//목록으로가기
function backlist(){
	var url = '/board/list?'+'page='+[[${paging.cri.page}]]+'&perPageNum='+[[${paging.cri.perPageNum}]];
	console.log(url);
	location.href= url;	
	
}
//글 수정 
function boardupdate(){
	var boardTitle = $('#boardTitle').val();
	var boardContents = $('#boardContents').val();
	var boardId =$('#boardId').val();
	var frmdata ={
			boardTitle,
			boardContents,
			boardId
		}
	console.log(frmdata);
	$.ajax({
		url:'/api/board/'+boardId,
		type:'PUT',
		data:JSON.stringify(frmdata),
		contentType:'application/json'
	}).done(function(data,textStatus,xhr){
		console.log(data);
		console.log(xhr);
		alert('success');
	}).fail(function(data,textStatus,xhr){
		console.log(xhr);
		alert('fail');
	}).always(function(data,textStatus,xhr){
		console.log(xhr);
		alert('???');
	});
	console.log(frmdata);
	location.href='/board/list?'+'page='+[[${paging.cri.page}]]+'&perPageNum='+[[${paging.cri.perPageNum}]];;
}
//글 삭제
function boardDelete(){
	var boardId = $('#boardId').val();
	var Isconfirm = confirm('정말 삭제하시겠습니까?');
	
	$.ajax({
		url:'/api/board/'+boardId,
		type:'delete',
		contentType:'application/json'
	}).done(function(data,textStatus,xhr){
		console.log(xhr);
		alert('success');
	}).fail(function(data,textStatus,xhr){
		console.log(xhr);
		alert('fail');
	}).always(function(data,textStatus,xhr){
		console.log(xhr);
		alert('???');
	});
	location.href='/board/list?'+'page='+[[${paging.cri.page}]]+'&perPageNum='+[[${paging.cri.perPageNum}]];
}
</script>
</html>